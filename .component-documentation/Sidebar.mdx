import { Meta, Story, Controls, Canvas, ArgTypes } from '@storybook/blocks';
import * as SidebarStories from './Sidebar.stories';
import { Sidebar } from './Sidebar';

<Meta of={SidebarStories} />


REALM AGENT NAVIGATION INDEX
=============================
Quick Reference for Claude Code Agents:

üì¶ IMPORT & SETUP (Lines 15-24)
- Basic import pattern
- Props documentation

üéØ BASIC USAGE (Lines 25-56)
- Default implementation with flexbox layout
- Default active state management
- Custom default active item

üìê LAYOUT INTEGRATION (Lines 58-104)
- Recommended Layout Pattern (Lines 62-84): Flexbox setup
- Right Position (Lines 86-104): Alternative positioning

üîÑ EXPANSION BEHAVIOR (Lines 106-154)
- Always Expanded (Lines 108-121): Default behavior
- Hover Expand (Lines 123-136): Compact sidebar option
- Controlled Expansion (Lines 138-154): Manual control

üéõÔ∏è MENU CONFIGURATION (Lines 156-262)
- Custom Menu Items (Lines 158-207): Structure and examples
- Menu Item Structure (Lines 209-222): TypeScript interface

üìä MENU SECTIONS (Lines 224-327)
- Main Navigation (Lines 228-262): Primary items
- Secondary Navigation (Lines 264-279): Additional items with divider
- Bottom Navigation (Lines 281-304): Settings/logout section
- Toggle Bottom Section (Lines 306-327): Dynamic visibility

‚ö° STATES & STYLING (Lines 329-372)
- Active State (Lines 331-349): Main/sub-menu styling differences
- Disabled Items (Lines 351-362): Coming soon features
- Parent Active State (Lines 364-372): Child selection effects

üåç INTERNATIONALIZATION (Lines 373-587)
- RTL Features (Lines 377-384): Automatic adjustments  
- RTL Usage (Lines 386-395): Automatic detection
- Bilingual Menu Items (Lines 397-409): Language switching
- RTL with ThemeProvider (Lines 410-486): Comprehensive RTL support
- Directional Icon Handling (Lines 487-531): RTL-aware icons
- RTL Best Practices (Lines 532-587): Implementation guidelines

‚ôø ACCESSIBILITY (Lines 589-612)
- Keyboard navigation support
- ARIA labels and screen reader compatibility
- Focus management

üìè SIZING & CUSTOMIZATION (Lines 614-662)
- Default dimensions and CSS variable customization
- CSS Variables table (Lines 636-650): Design tokens
- Custom Styling (Lines 652-662): Override examples

üíº COMMON USE CASES (Lines 664-738)
- Admin Dashboard (Lines 666-708): Complete example with hierarchical menus
- E-commerce Navigation (Lines 710-738): Product/order management

‚öôÔ∏è TECHNICAL DETAILS (Lines 740-781)
- Component Architecture (Lines 742-748): Recursive rendering
- Performance (Lines 749-754): Optimization details
- Browser Support (Lines 755-763): Compatibility matrix
- Migration Guide (Lines 765-781): From fixed layout

QUICK IMPLEMENTATION EXAMPLES:
- Basic sidebar: Lines 32-40
- Custom menu items: Lines 196-206
- Right position: Lines 98-102
- Hover expand: Lines 130-135
- RTL support: Lines 389-394
- Admin layout: Lines 514-528

‚ö†Ô∏è LAYOUT NOTE:
Sidebar uses flexbox layout that pushes content instead of overlaying. Use display: flex on parent container and flex: 1 on main content area.

‚ö†Ô∏è FALLBACK INSTRUCTION:
If you cannot find what you're looking for in the sections above, 
read the ENTIRE document from start to finish to ensure complete 
understanding of all Sidebar component capabilities and patterns.


# Sidebar Component

The Sidebar component provides expandable navigation for applications with hierarchical menu structures, RTL support, and flexible layout integration. It supports hover-to-expand behavior, multi-level navigation, and proper content pushing instead of overlaying.

## Overview

The Sidebar is a primary navigation component that organizes menu items into logical groups with support for parent-child relationships. It integrates naturally with page layouts using flexbox, automatically adjusting content when expanded or collapsed.

## Import

```jsx
import { Sidebar } from '@tagaddod-design/react';
```

## Props

<ArgTypes of={Sidebar} />

## Basic Usage

<Canvas of={SidebarStories.Default} />

```jsx
// Basic sidebar with default menu items and default active item
<div style={{ display: 'flex', height: '100vh' }}>
  <Sidebar 
    selectedItem="page1"
    onItemChange={setSelectedItem}
    // Page 1 is active by default when no selectedItem is provided
  />
  <main style={{ flex: 1, padding: '24px' }}>
    Your main content here
  </main>
</div>
```

### Default Active State

The Sidebar automatically shows a default active item (`'page1'`) when no `selectedItem` is provided, ensuring a consistent visual state on initial load.

```jsx
// Default active item (page1)
<Sidebar onItemChange={setSelectedItem} />

// Custom default active item
<Sidebar 
  defaultSelectedItem="page2"
  onItemChange={setSelectedItem} 
/>
```

## Layout Integration

The Sidebar component is designed to work with flexbox layouts, pushing content instead of overlaying it.

### Recommended Layout Pattern

```jsx
function AppLayout() {
  const [selectedItem, setSelectedItem] = useState('page1');
  
  return (
    <div style={{ display: 'flex', height: '100vh' }}>
      <Sidebar 
        selectedItem={selectedItem}
        onItemChange={setSelectedItem}
      />
      <main style={{ 
        flex: 1, 
        padding: '24px',
        overflow: 'auto'
      }}>
        <AppContent />
      </main>
    </div>
  );
}
```

### Right Position

<Canvas of={SidebarStories.RightPosition} />

```jsx
// For right-positioned sidebar, use flex-direction: row-reverse
<div style={{ 
  display: 'flex', 
  height: '100vh',
  flexDirection: 'row-reverse' 
}}>
  <Sidebar 
    position="right"
    selectedItem="users"
    onItemChange={setSelectedItem}
  />
  <main style={{ flex: 1 }}>Content</main>
</div>
```

## Expansion Behavior

### Always Expanded (Default)

The sidebar is expanded by default and does not respond to hover interactions.

<Canvas of={SidebarStories.Default} />

```jsx
<Sidebar 
  defaultExpanded={true} // Default behavior
  hoverExpand={false}    // Default behavior
  selectedItem="page1"
  onItemChange={setSelectedItem}
/>
```

### Hover Expand

Enable hover-to-expand behavior for a more compact sidebar.

<Canvas of={SidebarStories.AlwaysExpanded} />

```jsx
<Sidebar 
  defaultExpanded={false}
  hoverExpand={true}
  selectedItem="page1"
  onItemChange={setSelectedItem}
/>
```

### Controlled Expansion

<Canvas of={SidebarStories.ControlledExpansion} />

```jsx
function ControlledSidebar() {
  const [expanded, setExpanded] = useState(false);
  
  return (
    <Sidebar
      expanded={expanded}
      onExpandedChange={setExpanded}
      hoverExpand={false}
    />
  );
}
```

## Menu Configuration

### Custom Menu Items

<Canvas of={SidebarStories.CustomMenus} />

```jsx
const menuItems = [
  {
    id: 'products',
    icon: IconPackage,
    label: 'Products',
    hasChildren: true,
    children: [
      { id: 'add-product', label: 'Add Product' },
      { id: 'manage-products', label: 'Manage Products' },
      { id: 'categories', label: 'Categories' }
    ]
  },
  {
    id: 'sales',
    icon: IconChartBar,
    label: 'Sales'
  }
];

const secondaryItems = [
  {
    id: 'customers',
    icon: IconUsers,
    label: 'Customers'
  },
  {
    id: 'support',
    icon: IconBell,
    label: 'Support',
    disabled: true // Disabled item example
  }
];

<Sidebar
  menuItems={menuItems}
  secondaryItems={secondaryItems}
  bottomItems={[
    {
      id: 'help',
      icon: IconSettings,
      label: 'Help & Support'
    }
  ]}
/>
```

### Menu Item Structure

```typescript
interface SidebarMenuItem {
  id: string;                    // Unique identifier
  icon?: React.ComponentType;    // Icon component (optional)
  label: string;                 // Display text
  labelEn?: string;             // English label for i18n
  labelAr?: string;             // Arabic label for i18n
  hasChildren?: boolean;        // Has sub-items
  children?: SidebarMenuItem[]; // Sub-menu items
  disabled?: boolean;           // Disabled state
}
```

## Menu Sections

The sidebar organizes menu items into three logical sections:

### Main Navigation (`menuItems`)

Primary navigation items. By default, contains two simple navigation items: Page 1 and Page 2.

```jsx
// Default main navigation (non-expandable)
const defaultMenuItems = [
  {
    id: 'page1',
    icon: IconHome,
    label: 'Page 1',
    hasChildren: false
  },
  {
    id: 'page2',
    icon: IconChartBar,
    label: 'Page 2',
    hasChildren: false
  }
];

// Custom main navigation with children
const customMenuItems = [
  {
    id: 'dashboard',
    icon: IconHome,
    label: 'Dashboard',
    hasChildren: true,
    children: [
      { id: 'overview', label: 'Overview' },
      { id: 'analytics', label: 'Analytics' }
    ]
  }
];
```

### Secondary Navigation (`secondaryItems`)

Additional navigation items separated by a divider. Hidden by default - pass custom items to show.

```jsx
// Enable secondary navigation
const secondaryItems = [
  {
    id: 'settings',
    icon: IconSettings,
    label: 'Settings'
  }
];

<Sidebar secondaryItems={secondaryItems} />
```

### Bottom Navigation (`bottomItems`)

Items displayed at the bottom, typically for settings and logout. Hidden by default - enable with `showBottomSection={true}`.

```jsx
const bottomItems = [
  {
    id: 'settings',
    icon: IconSettings,
    label: 'Settings'
  },
  {
    id: 'logout',
    icon: IconLogout,
    label: 'Logout'
  }
];

// Show bottom section
<Sidebar bottomItems={bottomItems} showBottomSection={true} />

// Hide bottom section (default)
<Sidebar bottomItems={bottomItems} showBottomSection={false} />
```

### Toggle Bottom Section

Control the visibility of the bottom section containing settings and logout items:

```jsx
function ConditionalBottomSection() {
  const [showBottom, setShowBottom] = useState(true);
  
  return (
    <div>
      <button onClick={() => setShowBottom(!showBottom)}>
        {showBottom ? 'Hide' : 'Show'} Bottom Section
      </button>
      <Sidebar 
        showBottomSection={showBottom}
        selectedItem="dashboard"
        onItemChange={setSelectedItem}
      />
    </div>
  );
}
```

## States and Styling

### Active State

The Sidebar supports different active states for main menu items and sub-menu items:

- **Main menu items**: Show brand secondary background with white text
- **Sub-menu items**: Show blue text with transparent background

```jsx
<Sidebar 
  selectedItem="analytics" // Sets active state
  onItemChange={setSelectedItem}
/>

// Sub-menu item active styling (blue text, no background)
<Sidebar 
  selectedItem="electronics" // Child of dashboard
  onItemChange={setSelectedItem}
/>
```

### Disabled Items

```jsx
const menuItems = [
  {
    id: 'disabled-feature',
    icon: IconUsers,
    label: 'Coming Soon',
    disabled: true // Item appears disabled
  }
];
```

### Parent Active State

When a child item is selected, its parent automatically shows an active state.

```jsx
// If selectedItem is "page1", it will show active state
<Sidebar selectedItem="page1" />
```

## Internationalization and RTL Support

The Sidebar component provides comprehensive Right-to-Left (RTL) language support when used with the `ThemeProvider`. This includes automatic font switching, proper border positioning, and directional icon handling.

### Using with ThemeProvider

For full RTL support, wrap your application with `ThemeProvider`:

```jsx
import { ThemeProvider, Sidebar } from '@tagaddod-design/react';
import { IconHome, IconChartBar, IconArrowRight } from '@tabler/icons-react';

function App() {
  return (
    <ThemeProvider defaultDirection="rtl" defaultLocale="ar">
      <div style={{ display: 'flex', height: '100vh' }}>
        <Sidebar 
          selectedItem="dashboard"
          onItemChange={setSelectedItem}
          menuItems={[
            {
              id: 'dashboard',
              icon: IconHome,
              label: 'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ',
              hasChildren: true,
              children: [
                { id: 'overview', label: 'ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ©' },
                { id: 'analytics', label: 'ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™' }
              ]
            }
          ]}
        />
        <main style={{ flex: 1, padding: '24px' }}>
          ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
        </main>
      </div>
    </ThemeProvider>
  );
}
```

### Automatic RTL Adjustments

When RTL is enabled via ThemeProvider, the Sidebar component automatically:

1. **Font Switching**: Changes from Outfit (English) to Tajawal (Arabic) font
2. **Border Positioning**: Switches border from right to left in RTL mode
3. **Text Alignment**: Menu labels align to the right for Arabic text
4. **Line Height**: Applies appropriate line height for Arabic text rendering
5. **Icon Positioning**: Icons maintain proper spacing in RTL layouts
6. **Layout Direction**: Maintains proper positioning when parent uses RTL
7. **Menu Hierarchy**: Sub-menu indentation adjusts for RTL text flow

### Directional Icon Handling

**Important**: When using directional icons (arrows, chevrons, etc.) in sidebar navigation, you should manually choose the appropriate icon based on the current direction:

```jsx
import { useTheme } from '@tagaddod-design/react';
import { IconArrowLeft, IconArrowRight, IconChevronLeft, IconChevronRight } from '@tabler/icons-react';

function DirectionalSidebar() {
  const { isRTL } = useTheme();
  
  // Use chevrons pointing in the correct direction for expansion
  const ExpandIcon = isRTL ? IconChevronLeft : IconChevronRight;
  const BackIcon = isRTL ? IconArrowRight : IconArrowLeft;
  
  const menuItems = [
    {
      id: 'navigation',
      icon: BackIcon,
      label: isRTL ? 'ÿßŸÑÿ™ŸÜŸÇŸÑ' : 'Navigation',
      hasChildren: true,
      children: [
        { 
          id: 'next-page', 
          label: isRTL ? 'ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ©' : 'Next Page',
          // Note: Child items don't typically need directional icons
        }
      ]
    }
  ];
  
  return (
    <div style={{ display: 'flex', height: '100vh' }}>
      <Sidebar 
        menuItems={menuItems}
        selectedItem="navigation"
        onItemChange={setSelectedItem}
      />
      <main style={{ flex: 1 }}>
        {isRTL ? 'ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ' : 'Content'}
      </main>
    </div>
  );
}
```

### Common Directional Icon Patterns

#### Navigation Icons
```jsx
// For "back" navigation in sidebar
const BackIcon = isRTL ? IconArrowRight : IconArrowLeft;

<Sidebar menuItems={[{
  id: 'back',
  icon: BackIcon,
  label: isRTL ? 'ÿ±ÿ¨Ÿàÿπ' : 'Back'
}]} />
```

#### Expansion Icons
```jsx
// For expandable menu sections (handled automatically by Sidebar)
// The component uses IconChevronRight/IconChevronDown for expansion
// and handles RTL direction internally
```

#### Action Icons
```jsx
// For "next step" or "proceed" actions
const NextIcon = isRTL ? IconArrowLeft : IconArrowRight;

<Sidebar menuItems={[{
  id: 'next',
  icon: NextIcon,
  label: isRTL ? 'ÿßŸÑÿ™ÿßŸÑŸä' : 'Next'
}]} />
```

### Bilingual Menu Items

For applications supporting multiple languages, you can provide both English and Arabic labels:

```jsx
const bilingualMenuItems = [
  {
    id: 'dashboard',
    icon: IconHome,
    label: isRTL ? 'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ' : 'Dashboard',
    labelEn: 'Dashboard',
    labelAr: 'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ',
    hasChildren: true,
    children: [
      {
        id: 'overview',
        label: isRTL ? 'ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ©' : 'Overview',
        labelEn: 'Overview',
        labelAr: 'ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ©'
      }
    ]
  }
];

<Sidebar menuItems={bilingualMenuItems} />
```

### RTL Layout Integration

The Sidebar works seamlessly with RTL layouts using flexbox:

```jsx
import { useTheme } from '@tagaddod-design/react';

function RTLLayout() {
  const { isRTL } = useTheme();
  
  return (
    <div style={{ 
      display: 'flex', 
      height: '100vh',
      // Reverse flex direction for RTL to position sidebar on the right
      flexDirection: isRTL ? 'row-reverse' : 'row'
    }}>
      <Sidebar 
        position={isRTL ? 'right' : 'left'}
        selectedItem="dashboard"
        onItemChange={setSelectedItem}
      />
      <main style={{ 
        flex: 1, 
        padding: '24px',
        textAlign: isRTL ? 'right' : 'left',
        direction: isRTL ? 'rtl' : 'ltr'
      }}>
        {isRTL ? 'ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ' : 'Main application content'}
      </main>
    </div>
  );
}
```

### RTL Best Practices

1. **Always use ThemeProvider** for proper RTL support and font switching
2. **Choose directional icons carefully** - arrows should point in the reading direction
3. **Test with actual Arabic content** to ensure proper menu item rendering
4. **Use `useTheme` hook** to access RTL state and theme information
5. **Consider sidebar positioning** - RTL layouts often place navigation on the right
6. **Verify menu hierarchy** - ensure sub-menu indentation works correctly in RTL
7. **Test expansion behavior** - hover and click interactions should feel natural
8. **Check border positioning** - borders should switch sides appropriately

## Accessibility

The Sidebar component includes comprehensive accessibility features:

- **Keyboard Navigation**: Full support for Tab, Arrow keys, Enter, and Escape
- **ARIA Labels**: Proper `aria-label` attributes for screen readers
- **Focus Management**: Clear focus indicators and logical tab order
- **Screen Reader Support**: Semantic HTML structure with proper roles
- **High Contrast**: Support for `prefers-contrast: high`
- **Reduced Motion**: Respects `prefers-reduced-motion: reduce`

### Accessibility Best Practices

```jsx
<Sidebar 
  selectedItem="page1"
  onItemChange={setSelectedItem}
  // Component automatically provides:
  // - aria-label for menu items
  // - proper button roles
  // - keyboard navigation
  // - focus management
/>
```

## Sizing and Dimensions

```jsx
// Default sizes (customizable via CSS variables)
const sizes = {
  collapsed: '64px',      // 4rem
  expanded: '240px',      // 15rem
  height: '100vh'         // Full viewport height
};

// CSS variable customization
<Sidebar 
  style={{
    '--sidebar-width-collapsed': '80px',
    '--sidebar-width-expanded': '280px'
  }}
/>
```

## Styling Customization

### CSS Variables

The Sidebar uses design tokens for consistent styling:

| Variable | Purpose |
|----------|---------|
| `--t-color-surface-primary` | Background color |
| `--t-color-border-secondary` | Border color |
| `--t-color-text-primary` | Inactive text color |
| `--t-color-text-link` | Active text color |
| `--t-color-fill-brand-secondary` | Active background |
| `--t-space-200/300/400/1000` | Padding and spacing |
| `--t-font-family-primary` | English font family |
| `--t-font-family-arabic` | Arabic font family |
| `--t-border-radius-200` | Border radius |
| `--t-duration-300` | Animation duration |

### Custom Styling

```jsx
<Sidebar 
  className="custom-sidebar"
  style={{
    '--sidebar-width-expanded': '320px',
    '--custom-shadow': '0 4px 12px rgba(0,0,0,0.1)'
  }}
/>
```

## Common Use Cases

### Admin Dashboard

```jsx
function AdminLayout() {
  const [selectedItem, setSelectedItem] = useState('overview');
  
  const adminMenuItems = [
    {
      id: 'dashboard',
      icon: IconHome,
      label: 'Dashboard',
      hasChildren: true,
      children: [
        { id: 'overview', label: 'Overview' },
        { id: 'analytics', label: 'Analytics' },
        { id: 'reports', label: 'Reports' }
      ]
    },
    {
      id: 'users',
      icon: IconUsers,
      label: 'User Management'
    }
  ];
  
  return (
    <div style={{ display: 'flex', height: '100vh' }}>
      <Sidebar
        selectedItem={selectedItem}
        onItemChange={setSelectedItem}
        menuItems={adminMenuItems}
        bottomItems={[
          { id: 'settings', icon: IconSettings, label: 'Settings' },
          { id: 'logout', icon: IconLogout, label: 'Logout' }
        ]}
      />
      <main style={{ flex: 1, overflow: 'auto' }}>
        <AdminContent selectedTab={selectedItem} />
      </main>
    </div>
  );
}
```

### E-commerce Navigation

```jsx
const ecommerceMenu = [
  {
    id: 'products',
    icon: IconPackage,
    label: 'Products',
    hasChildren: true,
    children: [
      { id: 'all-products', label: 'All Products' },
      { id: 'add-product', label: 'Add Product' },
      { id: 'categories', label: 'Categories' },
      { id: 'inventory', label: 'Inventory' }
    ]
  },
  {
    id: 'orders',
    icon: IconShoppingCart,
    label: 'Orders',
    hasChildren: true,
    children: [
      { id: 'all-orders', label: 'All Orders' },
      { id: 'pending', label: 'Pending' },
      { id: 'shipped', label: 'Shipped' }
    ]
  }
];
```

## Implementation Details

### Component Architecture

1. **Menu Rendering**: Recursive rendering for hierarchical items
2. **State Management**: Internal state for expansion and group toggles
3. **RTL Detection**: Automatic detection from document properties
4. **Layout Integration**: Flexbox-based for natural content flow

### Performance

- **Efficient Re-renders**: Optimized with proper React patterns
- **CSS Transitions**: Smooth animations for expansion/collapse
- **Minimal Bundle**: Tree-shakeable with other components

### Browser Support

Compatible with all modern browsers including:
- Chrome/Chromium 88+
- Firefox 85+
- Safari 14+
- Edge 88+

Full RTL support in all supported browsers.

## Migration from Fixed Layout

If upgrading from a fixed-position sidebar:

```jsx
// Old: Fixed overlay pattern
<div>
  <Sidebar /> {/* Fixed positioned */}
  <div style={{ marginLeft: '240px' }}>Content</div>
</div>

// New: Flexible layout pattern
<div style={{ display: 'flex' }}>
  <Sidebar /> {/* Flexible positioned */}
  <div style={{ flex: 1 }}>Content</div>
</div>
```