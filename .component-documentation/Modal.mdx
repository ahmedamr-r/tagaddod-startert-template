import { Meta, Story, Controls, Canvas, ArgTypes } from '@storybook/blocks';
import * as ModalStories from './Modal.stories';
import { Modal } from './Modal';
import { Button } from '../Button/Button';

<Meta of={ModalStories} />

# 🚨 AI CODING AGENT - CRITICAL IMPLEMENTATION GUIDE 🚨

## MODAL COMPONENT ARCHITECTURE - READ FIRST
```
┌─────────────────────────────────────┐
│ HEADER (Controlled by Props)       │ ← title, showTitle, close button
├─────────────────────────────────────┤
│ BODY (Your Content Goes Here)      │ ← children prop ONLY
├─────────────────────────────────────┤
│ FOOTER (Controlled by Props)       │ ← footerVariant, primaryLabel, etc.
└─────────────────────────────────────┘
```

## ❌ CRITICAL MISTAKES TO AVOID
1. **❌ NEVER create manual footers in children**
2. **❌ NEVER add buttons inside children**
3. **❌ NEVER use custom button containers**
4. **❌ NEVER create `<div className="footer">` in children**

## ✅ CORRECT IMPLEMENTATION PATTERN
```jsx
// ✅ CORRECT - Default single button pattern
<Modal
  title="User Form"
  primaryLabel="Save"              // Single primary button (DEFAULT)
  onPrimary={handleSave}           // Button action
>
  {/* ONLY body content goes here */}
  <form>
    <input placeholder="Name" />
    <select>...</select>
  </form>
  {/* NO BUTTONS OR FOOTERS HERE */}
</Modal>

// ✅ CORRECT - Multiple buttons (only when needed)
<Modal
  title="User Form"
  footerVariant="cancelAndActions"  // Use when multiple buttons needed
  cancelLabel="Cancel"
  primaryLabel="Save"
  onCancel={handleCancel}
  onPrimary={handleSave}
>
  {/* Content only */}
</Modal

// ❌ WRONG - Manual footer creation
<Modal title="User Form">
  <form>
    <input placeholder="Name" />
  </form>
  {/* ❌ DON'T DO THIS */}
  <div className="footer">
    <button>Cancel</button>
    <button>Save</button>
  </div>
</Modal>
```

## 🎯 AI IMPLEMENTATION CHECKLIST
- [ ] Use `children` for body content ONLY
- [ ] **DEFAULT: Use single button with `primaryLabel` only**
- [ ] Use `footerVariant="cancelAndActions"` only when multiple buttons needed
- [ ] Never create manual `<footer>` elements
- [ ] Use `showFooter={false}` if no footer needed

---

# Modal Component

The Modal component is a dialog that appears on top of the main content to provide critical information or request user input.

## Import
```jsx
import { Modal } from '@tagaddod-design/react';
```

## Props
<ArgTypes of={Modal} />

## Basic Usage
<Canvas of={ModalStories.Default} />

```jsx
// DEFAULT: Single button pattern (most common)
<Modal
  trigger={<Button>Open Modal</Button>}
  title="Modal Title"
  primaryLabel="OK"           // Single button (DEFAULT)
  onPrimary={() => closeModal()}
>
  <div style={{ padding: '16px' }}>
    Modal content goes here
  </div>
</Modal>
```

## ❌ COMMON AI AGENT MISTAKES

### Mistake 1: Manual Footer Creation
```jsx
// ❌ WRONG - Don't create manual footers
<Modal title="Delete Confirmation">
  <p>Are you sure?</p>
  <div style={{display: 'flex', justifyContent: 'flex-end'}}>
    <button>Cancel</button>
    <button>Delete</button>
  </div>
</Modal>

// ✅ CORRECT - Single button (DEFAULT)
<Modal
  title="Delete Confirmation"
  primaryLabel="Delete"        // Single button for simple actions
  onPrimary={handleDelete}
>
  <p>Are you sure you want to delete this item?</p>
</Modal>

// ✅ CORRECT - Multiple buttons (when user needs choice)
<Modal
  title="Delete Confirmation"
  footerVariant="cancelAndActions"  // Only when multiple buttons needed
  cancelLabel="Cancel"
  primaryLabel="Delete"
  onCancel={handleCancel}
  onPrimary={handleDelete}
>
  <p>Are you sure?</p>
</Modal>
```

### Mistake 2: Form with Manual Submit Buttons
```jsx
// ❌ WRONG - Manual form buttons
<Modal title="User Registration">
  <form>
    <input name="email" />
    <div className="form-actions">
      <button type="submit">Register</button>
    </div>
  </form>
</Modal>

// ✅ CORRECT - Single button (DEFAULT)
<Modal
  title="User Registration"
  primaryLabel="Register"      // Single button for forms
  onPrimary={handleSubmit}
>
  <form>
    <input name="email" />
  </form>
</Modal>
```

## STEP-BY-STEP IMPLEMENTATION

### Step 1: Simple Confirmation Dialog
```jsx
// DEFAULT: Single button for simple confirmations
<Modal
  title="Confirm Action"
  primaryLabel="Continue"        // Single button (DEFAULT)
  onPrimary={() => {
    performAction();
    setShowModal(false);
  }}
  open={showModal}
  onOpenChange={setShowModal}
>
  <div style={{ padding: '16px' }}>
    <p>Click Continue to perform this action.</p>
  </div>
</Modal>

// Only use multiple buttons when user needs choice
<Modal
  title="Confirm Deletion"
  footerVariant="cancelAndActions"  // When user needs to cancel
  cancelLabel="No, Cancel"
  primaryLabel="Yes, Delete"
  onCancel={() => setShowModal(false)}
  onPrimary={() => {
    performAction();
    setShowModal(false);
  }}
>
  <div style={{ padding: '16px' }}>
    <p>Are you sure you want to delete this item?</p>
  </div>
</Modal>
```

### Step 2: Form Modal
```jsx
// DEFAULT: Single button for forms
<Modal
  title="Add New User"
  primaryLabel="Add User"         // Single submit button (DEFAULT)
  onPrimary={() => submitUser(formData)}
>
  <div style={{ padding: '16px', display: 'flex', flexDirection: 'column', gap: '16px' }}>
    <input
      placeholder="Full Name"
      value={formData.name}
      onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}
    />
    <input
      placeholder="Email"
      value={formData.email}
      onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))}
    />
  </div>
</Modal>
```

### Step 3: Scrollable Content
```jsx
// DEFAULT: Single button for simple acceptance
<Modal
  title="Terms and Conditions"
  scrollable={true}
  maxHeight="60vh"
  primaryLabel="I Understand"     // Single button (DEFAULT)
  onPrimary={() => acceptTerms()}
>
  <div>
    <h3>1. Introduction</h3>
    <p>Long content that will scroll...</p>
    {/* More content sections */}
  </div>
</Modal>

// Use multiple buttons only when user needs choice
<Modal
  title="Terms and Conditions"
  scrollable={true}
  maxHeight="60vh"
  footerVariant="cancelAndActions"  // When user can decline
  cancelLabel="Decline"
  primaryLabel="Accept"
  onCancel={() => setShowModal(false)}
  onPrimary={() => acceptTerms()}
>
  <div>
    <h3>1. Introduction</h3>
    <p>Long content that will scroll...</p>
  </div>
</Modal>
```

## Footer Variants

### Default: Single Button (Most Common)
```jsx
// ✅ DEFAULT: Use this pattern first
<Modal
  primaryLabel="Save"         // Single button (DEFAULT)
  onPrimary={handleSave}
>
  {/* Content only */}
</Modal>
// Renders:                   [Save]
```

### cancelAndActions (Use Only When Multiple Buttons Needed)
```jsx
// Use only when user needs choice between cancel and action
<Modal
  footerVariant="cancelAndActions"
  cancelLabel="Cancel"        // Left side
  primaryLabel="Save"         // Right side
  secondaryLabel="Draft"      // Right side
>
  {/* Content only */}
</Modal>
// Renders: [Cancel]           [Draft] [Save]
```

### swapAndActions
```jsx
<Modal
  footerVariant="swapAndActions"
  swapContent={<span>Auto-saved</span>}  // Left side
  primaryLabel="Publish"                 // Right side
>
  {/* Content only */}
</Modal>
// Renders: [Auto-saved]       [Publish]
```

### actionsOnly
```jsx
<Modal
  footerVariant="actionsOnly"
  primaryLabel="Continue"     // Right side
  secondaryLabel="Back"       // Right side
>
  {/* Content only */}
</Modal>
// Renders:                   [Back] [Continue]
```

## Width Sizes

### Small Width (424px)
<Canvas of={ModalStories.SmallWidth} />
```jsx
<Modal width="small" title="Small Modal">
  <div style={{ padding: '16px' }}>Perfect for confirmations</div>
</Modal>
```

### Medium Width (620px) - Default
<Canvas of={ModalStories.MediumWidth} />
```jsx
<Modal width="medium" title="Medium Modal">
  <div style={{ padding: '16px' }}>Ideal for most content</div>
</Modal>
```

### Large Width (980px)
<Canvas of={ModalStories.LargeWidth} />
```jsx
<Modal width="large" title="Large Modal">
  <div style={{ padding: '16px' }}>For complex content</div>
</Modal>
```

### Custom Width
<Canvas of={ModalStories.CustomWidth} />
```jsx
<Modal width="custom" customWidth="50rem" title="Custom Width">
  <div style={{ padding: '16px' }}>Custom dimensions</div>
</Modal>
```

## Content Padding Control

### Default Padding
<Canvas of={ModalStories.Default} />
```jsx
<Modal title="Default Padding">
  <div>Content with default padding (--t-space-500)</div>
</Modal>
```

### Custom Padding
<Canvas of={ModalStories.CustomContentPadding} />
```jsx
<Modal contentPadding="var(--t-space-700)" title="Custom Padding">
  <div>Content with larger padding</div>
</Modal>
```

### No Padding
<Canvas of={ModalStories.NoContentPadding} />
```jsx
<Modal contentPadding="0" title="No Padding">
  <div style={{ padding: '16px', backgroundColor: '#f0f0f0' }}>
    Custom layout control
  </div>
</Modal>
```

## Component Integration

### With Select Components
<Canvas of={ModalStories.FormWithSelect} />
```jsx
<Modal
  title="User Preferences"
  scrollable={true}
  maxHeight="500px"
  footerVariant="cancelAndActions"
  primaryLabel="Save"
>
  <div style={{ padding: '16px', display: 'flex', flexDirection: 'column', gap: '16px' }}>
    <Select
      label="Country"
      options={countryOptions}
      value={preferences.country}
      onValueChange={(value) => setPreferences(prev => ({ ...prev, country: value }))}
    />
    <Select
      label="Language"
      options={languageOptions}
      value={preferences.language}
      onValueChange={(value) => setPreferences(prev => ({ ...prev, language: value }))}
    />
  </div>
</Modal>
```

### Scrollable Content Example
<Canvas of={ModalStories.ScrollableContent} />

## RTL Support

The Modal automatically supports RTL when used with ThemeProvider:

```jsx
import { ThemeProvider } from '@tagaddod-design/react';

<ThemeProvider defaultDirection="rtl" defaultLocale="ar">
  <Modal
    title="عنوان النافذة"
    cancelLabel="إلغاء"
    primaryLabel="تأكيد"
  >
    <div style={{ padding: '16px', textAlign: 'right' }}>
      محتوى النافذة باللغة العربية
    </div>
  </Modal>
</ThemeProvider>
```

### Arabic Content Example
<Canvas of={ModalStories.ArabicContent} />

## Common Use Cases

### Confirmation Dialog
```jsx
const DeleteConfirmation = ({ item, onConfirm }) => (
  <Modal
    title="Confirm Deletion"
    width="small"
    footerVariant="cancelAndActions"
    cancelLabel="Keep Item"
    primaryLabel={`Delete ${item.type}`}
    onCancel={closeModal}
    onPrimary={() => onConfirm(item.id)}
  >
    <div style={{ padding: '16px', textAlign: 'center' }}>
      <p>Delete <strong>{item.name}</strong>?</p>
    </div>
  </Modal>
);
```

### Information Display
```jsx
<Modal
  title="User Details"
  showFooter={false}  // No footer needed
>
  <div style={{ padding: '16px' }}>
    <h3>John Doe</h3>
    <p><strong>Email:</strong> john@example.com</p>
    <p><strong>Role:</strong> Administrator</p>
  </div>
</Modal>
```

### Multi-Step Form
```jsx
<Modal
  title={`Step ${currentStep} of 3`}
  footerVariant="cancelAndActions"
  cancelLabel="Cancel"
  primaryLabel={currentStep === 3 ? "Complete" : "Next"}
  secondaryLabel={currentStep > 1 ? "Back" : undefined}
  showSecondaryButton={currentStep > 1}
  onCancel={closeModal}
  onPrimary={currentStep === 3 ? completeForm : nextStep}
  onSecondary={previousStep}
>
  <div style={{ padding: '16px' }}>
    {/* Step content based on currentStep */}
    {currentStep === 1 && <PersonalInfoForm />}
    {currentStep === 2 && <AddressForm />}
    {currentStep === 3 && <ReviewForm />}
  </div>
</Modal>
```

## Header/Footer Control

### Without Title
<Canvas of={ModalStories.WithoutTitle} />
```jsx
<Modal showTitle={false}>
  <div style={{ padding: '16px' }}>Content without title bar</div>
</Modal>
```

### Without Footer
<Canvas of={ModalStories.WithoutFooter} />
```jsx
<Modal title="Info Modal" showFooter={false}>
  <div style={{ padding: '16px' }}>
    Content without action buttons
    <div style={{ marginTop: '16px', textAlign: 'right' }}>
      <Button onClick={closeModal}>Close</Button>
    </div>
  </div>
</Modal>
```

## Advanced Features

### Dynamic Footer Control
<Canvas of={ModalStories.DynamicFooter} />

### Footer Variants Showcase
<Canvas of={ModalStories.CancelAndActions} />
<Canvas of={ModalStories.SwapAndActions} />
<Canvas of={ModalStories.ActionsOnly} />

## Accessibility

The Modal component provides comprehensive accessibility:

- Built on Radix UI Dialog primitive
- Focus management and trapping
- Keyboard navigation (Tab, Escape)
- Proper ARIA attributes
- Screen reader support
- Background scroll prevention

## Technical Details

### CSS Variables
- `--t-z-modal: 1050` - Modal z-index
- `--t-z-drawer-modal: 1070` - Higher z-index when opened from drawer
- Design tokens for colors, spacing, typography

### Browser Support
Compatible with all modern browsers with full RTL support.

---

## 🎯 QUICK REFERENCE FOR AI AGENTS

### ✅ DO THIS (DEFAULT):
```jsx
<Modal
  title="Title"
  primaryLabel="Save"         // Single button (DEFAULT)
  onPrimary={handleSave}
>
  <div>Content only</div>
</Modal>
```

### ✅ Multiple buttons (only when needed):
```jsx
<Modal
  title="Title"
  footerVariant="cancelAndActions"  // Only when user needs choice
  cancelLabel="Cancel"
  primaryLabel="Save"
  onCancel={handleCancel}
  onPrimary={handleSave}
>
  <div>Content only</div>
</Modal>
```

### ❌ NEVER DO THIS:
```jsx
<Modal title="Title">
  <div>Content</div>
  <div className="footer">  {/* ❌ */}
    <button>Save</button>
  </div>
</Modal>
```

**Remember: Use `children` for content, use props for footer!**